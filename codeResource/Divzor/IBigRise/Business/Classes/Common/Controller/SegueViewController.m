
#import <Foundation/Foundation.h>

NSString *StringFromRefugeData(Byte *data);        


//: #612CF9
Byte moduleMushData[] = {38, 7, 45, 9, 145, 170, 181, 171, 157, 246, 9, 4, 5, 22, 25, 12, 61};

//: main_tab_my
Byte styleItemDevice[] = {81, 11, 80, 7, 90, 207, 179, 29, 17, 25, 30, 15, 36, 17, 18, 15, 29, 41, 71};

//: icon_setting_normal
Byte featureStareContent[] = {65, 19, 65, 9, 36, 223, 148, 226, 84, 40, 34, 46, 45, 30, 50, 36, 51, 51, 40, 45, 38, 30, 45, 46, 49, 44, 32, 43, 177};

//: icon_contact_normal
Byte featureArrowSelectLifeKey[] = {37, 19, 70, 12, 23, 105, 149, 175, 152, 226, 183, 220, 35, 29, 41, 40, 25, 29, 41, 40, 46, 27, 29, 46, 25, 40, 41, 44, 39, 27, 38, 19};

//: badgeValue
Byte spacingMeantimeTrackPath[] = {36, 10, 74, 8, 221, 64, 201, 103, 24, 23, 26, 29, 27, 12, 23, 34, 43, 27, 214};

//: icon_message_pressed
Byte commonMarginTimer[] = {74, 20, 96, 13, 129, 27, 46, 97, 84, 14, 119, 129, 45, 9, 3, 15, 14, 255, 13, 5, 19, 19, 1, 7, 5, 255, 16, 18, 5, 19, 19, 5, 4, 173};

//: #000000
Byte screenIslandScandalData[] = {33, 7, 11, 8, 252, 124, 120, 252, 24, 37, 37, 37, 37, 37, 37, 227};

//: activity_user_profile_chat
Byte viewMovieSettings[] = {85, 26, 37, 12, 146, 32, 104, 214, 90, 253, 243, 5, 60, 62, 79, 68, 81, 68, 79, 84, 58, 80, 78, 64, 77, 58, 75, 77, 74, 65, 68, 71, 64, 58, 62, 67, 60, 79, 131};

//: icon_setting_pressed
Byte widgetEnvelopConfig[] = {70, 20, 30, 5, 195, 75, 69, 81, 80, 65, 85, 71, 86, 86, 75, 80, 73, 65, 82, 84, 71, 85, 85, 71, 70, 188};

//: #875FFA
Byte spacingItemHelper[] = {48, 7, 70, 14, 116, 169, 95, 250, 201, 191, 186, 228, 28, 90, 221, 242, 241, 239, 0, 0, 251, 246};

//: selectedImage
Byte widgetGrainName[] = {88, 13, 49, 9, 105, 181, 99, 199, 86, 66, 52, 59, 52, 50, 67, 52, 51, 24, 60, 48, 54, 52, 179};

//: icon_contact_pressed
Byte viewPlacementFormat[] = {8, 20, 95, 5, 226, 10, 4, 16, 15, 0, 4, 16, 15, 21, 2, 4, 21, 0, 17, 19, 6, 20, 20, 6, 5, 28};

//: image
Byte viewSequencePreference[] = {73, 5, 74, 10, 255, 7, 103, 254, 158, 248, 31, 35, 23, 29, 27, 235};

//: vc
Byte widgetTapName[] = {4, 2, 57, 7, 94, 197, 225, 61, 42, 221};

//: #A148FF
Byte appEverSequenceDevice[] = {52, 7, 45, 10, 191, 95, 233, 63, 75, 172, 246, 20, 4, 7, 11, 25, 25, 159};

//: 视频
Byte kEntityChef[] = {32, 6, 19, 14, 241, 130, 76, 241, 253, 25, 128, 69, 209, 51, 213, 148, 115, 214, 143, 126, 91};

//: #888888
Byte kBuildSettings[] = {25, 7, 57, 8, 38, 179, 166, 109, 234, 255, 255, 255, 255, 255, 255, 247};

//: KEKENotificationLanguageChanged
Byte widgetTerrainGlobalTitle[] = {27, 31, 16, 6, 43, 5, 59, 53, 59, 53, 62, 95, 100, 89, 86, 89, 83, 81, 100, 89, 95, 94, 60, 81, 94, 87, 101, 81, 87, 85, 51, 88, 81, 94, 87, 85, 84, 105};

//: contacts_list_title
Byte kJoinMarkKey[] = {83, 19, 19, 4, 80, 92, 91, 97, 78, 80, 97, 96, 76, 89, 86, 96, 97, 76, 97, 86, 97, 89, 82, 216};

//: NTESCustomNotificationCountChanged
Byte styleMatterText[] = {10, 34, 50, 7, 63, 197, 41, 28, 34, 19, 33, 17, 67, 65, 66, 61, 59, 28, 61, 66, 55, 52, 55, 49, 47, 66, 55, 61, 60, 17, 61, 67, 60, 66, 17, 54, 47, 60, 53, 51, 50, 159};

//: title
Byte widgetPrimeReceiveTimer[] = {57, 5, 93, 11, 184, 227, 148, 233, 120, 56, 129, 23, 12, 23, 15, 8, 250};

//: icon_message_normal
Byte viewTickMemoryMessage[] = {97, 19, 55, 13, 92, 201, 50, 187, 92, 73, 15, 88, 167, 50, 44, 56, 55, 40, 54, 46, 60, 60, 42, 48, 46, 40, 55, 56, 59, 54, 42, 53, 138};

// __DEBUG__
// __CLOSE_PRINT__
//
//  MainTabController.m
//  NIMDemo
//
//  Created by chris on 15/2/2.
//  Copyright (c) 2015年 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "NTESMainTabController.h"
#import "SegueViewController.h"
//: #import "NTESSessionListViewController.h"
#import "WarningViewController.h"
//: #import "UIImage+NTESColor.h"
#import "UIImage+PersonBroadcast.h"
//: #import "NTESCustomNotificationDB.h"
#import "BelowDb.h"
//: #import "NTESNotificationCenter.h"
#import "NotificationProceed.h"
//: #import "NTESNavigationHandler.h"
#import "PortStepGender.h"
//: #import "NTESNavigationAnimator.h"
#import "BasicNavigationAgency.h"
//: #import "NTESBundleSetting.h"
#import "AgencySetting.h"
//: #import "ZZZContactsViewController.h"
#import "HeadsUpViewController.h"
//: #import "ZZZVideoListViewController.h"
#import "AgencySucceedViewController.h"
//: #import "ZZZMainCenterViewController.h"
#import "ScaleViewController.h"
//: #import "CustomTabBar.h"
#import "SpeakeasyView.h"
//: #import "CustomTabBarController.h"
#import "NationalClimaticDataCenterViewController.h"

//: typedef NS_ENUM(NSInteger, EnumUserMainTabType) {
typedef NS_ENUM(NSInteger, EnumUserMainTabType) {
    //: EnumUserMainTabTypeMessageList, 
    EnumUserMainTabTypeMessageList, //聊天
    //: EnumUserMainTabTypeContact, 
    EnumUserMainTabTypeContact, //通讯录
    //: EnumUserMainTabTypeChatroomList, 
    EnumUserMainTabTypeChatroomList, //聊天室
    //: EnumUserMainTabTypeSetting, 
    EnumUserMainTabTypeSetting, //设置
//: };
};

//: @interface NTESMainTabController ()<NIMSystemNotificationManagerDelegate,NIMConversationManagerDelegate,NIMChatManagerDelegate,NIMLoginManagerDelegate,CustomTabBarControllerDelegate>
@interface SegueViewController ()<NIMSystemNotificationManagerDelegate,NIMConversationManagerDelegate,NIMChatManagerDelegate,NIMLoginManagerDelegate,BarA>

//: @property (nonatomic,assign) NSInteger systemUnreadCount;
@property (nonatomic,assign) NSInteger drama;

//: @property (nonatomic,assign) NSInteger customSystemUnreadCount;
@property (nonatomic,assign) NSInteger wait;

//: @property (nonatomic,strong) NSArray *navigationHandlers;
@property (nonatomic,strong) NSArray *memory;

//: @property (nonatomic,copy) NSDictionary *configs;
@property (nonatomic,copy) NSDictionary *requestConfigs;
@property (nonatomic,assign) NSInteger formatBehaviorQuantity;

//: @property (nonatomic,strong) NTESNavigationAnimator *animator;
@property (nonatomic,strong) BasicNavigationAgency *white;

//: @property (nonatomic,assign) NSInteger sessionUnreadCount;
@property (nonatomic,assign) NSInteger absoluteNumber;

//: @end
@end

//: @implementation NTESMainTabController
@implementation SegueViewController

//: - (void)didRemoveRecentSession:(NIMRecentSession *)recentSession totalUnreadCount:(NSInteger)totalUnreadCount{
- (void)didRemoveRecentSession:(NIMRecentSession *)recentSession totalUnreadCount:(NSInteger)totalUnreadCount{
    //: self.sessionUnreadCount = totalUnreadCount;
    self.absoluteNumber = totalUnreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}


//: + (instancetype)instance{
+ (instancetype)still{
    //: UIViewController *vc = [UIApplication sharedApplication].delegate.window.rootViewController;
    UIViewController *vc = [UIApplication sharedApplication].delegate.window.rootViewController;
    //: if ([vc isKindOfClass:[NTESMainTabController class]]) {
    if ([vc isKindOfClass:[SegueViewController class]]) {
        //: return (NTESMainTabController *)vc;
        return (SegueViewController *)vc;
    //: }else{
    }else{
        //: return nil;
        return nil;
    }
}

//: - (void)dealloc{
- (void)dealloc{
    //: [[NIMSDK sharedSDK].systemNotificationManager removeDelegate:self];
    [[NIMSDK sharedSDK].systemNotificationManager removeDelegate:self];
    //: [[NIMSDK sharedSDK].conversationManager removeDelegate:self];
    [[NIMSDK sharedSDK].conversationManager removeDelegate:self];
    //: [[NSNotificationCenter defaultCenter] removeObserver:self];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

//: - (void)allMessagesRead
- (void)allMessagesRead
{
    //: self.sessionUnreadCount = 0;
    self.absoluteNumber = 0;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}

//: - (void)refreshSessionBadge{
- (void)awake{
    //: NSString *badgeValue = self.sessionUnreadCount ? @(self.sessionUnreadCount).stringValue : nil;
    NSString *badgeValue = self.absoluteNumber ? @(self.absoluteNumber).stringValue : nil;
    //: [super setBadgeValue:badgeValue atIndex:EnumUserMainTabTypeMessageList];
    [super multiple:badgeValue than:EnumUserMainTabTypeMessageList];
}

//: #pragma mark - VC
#pragma mark - VC
//: - (NSDictionary *)vcInfoForTabType:(EnumUserMainTabType)type{
- (NSDictionary *)with:(EnumUserMainTabType)type{

    //: if (_configs == nil)
    if (_requestConfigs == nil)
    {
        //: _configs = @{
        _requestConfigs = @{
                     //: @(EnumUserMainTabTypeMessageList) : @{
                     @(EnumUserMainTabTypeMessageList) : @{
                             //: @"vc" : @"NTESSessionListViewController",
                             StringFromRefugeData(widgetTapName) : @"WarningViewController",
                             //: @"title" : [NTESLanguageManager getTextWithKey:@"activity_user_profile_chat"],
                             StringFromRefugeData(widgetPrimeReceiveTimer) : [BombardmentMinimumManageress more:StringFromRefugeData(viewMovieSettings)],
                             //: @"image" : @"icon_message_normal",
                             StringFromRefugeData(viewSequencePreference) : StringFromRefugeData(viewTickMemoryMessage),
                             //: @"selectedImage": @"icon_message_pressed",
                             StringFromRefugeData(widgetGrainName): StringFromRefugeData(commonMarginTimer),
                             //: @"badgeValue": @(self.sessionUnreadCount)
                             StringFromRefugeData(spacingMeantimeTrackPath): @(self.absoluteNumber)
                             //: },
                             },
                     //: @(EnumUserMainTabTypeContact) : @{
                     @(EnumUserMainTabTypeContact) : @{
                             //: @"vc" : @"ZZZContactsViewController",
                             StringFromRefugeData(widgetTapName) : @"HeadsUpViewController",
                             //: @"title" : [NTESLanguageManager getTextWithKey:@"contacts_list_title"],
                             StringFromRefugeData(widgetPrimeReceiveTimer) : [BombardmentMinimumManageress more:StringFromRefugeData(kJoinMarkKey)],
                             //: @"image" : @"icon_contact_normal",
                             StringFromRefugeData(viewSequencePreference) : StringFromRefugeData(featureArrowSelectLifeKey),
                             //: @"selectedImage": @"icon_contact_pressed",
                             StringFromRefugeData(widgetGrainName): StringFromRefugeData(viewPlacementFormat),
                             //: @"badgeValue": @(self.systemUnreadCount)
                             StringFromRefugeData(spacingMeantimeTrackPath): @([self principal:self.formatBehaviorQuantity])
                             //: },
                             },
                     //: @(EnumUserMainTabTypeChatroomList): @{
                     @(EnumUserMainTabTypeChatroomList): @{
                             //: @"vc" : @"ZZZMainCenterViewController",
                             StringFromRefugeData(widgetTapName) : @"ScaleViewController",
                             //: @"title" : [NTESLanguageManager getTextWithKey:@"main_tab_my"],
                             StringFromRefugeData(widgetPrimeReceiveTimer) : [BombardmentMinimumManageress more:StringFromRefugeData(styleItemDevice)],
                             //: @"image" : @"icon_setting_normal",
                             StringFromRefugeData(viewSequencePreference) : StringFromRefugeData(featureStareContent),
                             //: @"selectedImage": @"icon_setting_pressed",
                             StringFromRefugeData(widgetGrainName): StringFromRefugeData(widgetEnvelopConfig),
                             //: },
                             },
                     //: @(EnumUserMainTabTypeSetting) : @{
                     @(EnumUserMainTabTypeSetting) : @{
                             //: @"vc" : @"ZZZVideoListViewController",
                             StringFromRefugeData(widgetTapName) : @"AgencySucceedViewController",
                             //: @"title" : @"视频".string_localized,
                             StringFromRefugeData(widgetPrimeReceiveTimer) : StringFromRefugeData(kEntityChef).nameWithinCrossAllow,
                             //: @"image" : @"icon_setting_normal",
                             StringFromRefugeData(viewSequencePreference) : StringFromRefugeData(featureStareContent),
                             //: @"selectedImage": @"icon_setting_pressed",
                             StringFromRefugeData(widgetGrainName): StringFromRefugeData(widgetEnvelopConfig),
                             //: @"badgeValue": @(self.customSystemUnreadCount)
                             StringFromRefugeData(spacingMeantimeTrackPath): @(self.wait)
                             }
                     //: };
                     };

    }
    //: return _configs[@(type)];
    return _requestConfigs[@(type)];
}

//: - (UIStatusBarStyle)preferredStatusBarStyle {
- (UIStatusBarStyle)preferredStatusBarStyle {
    //: return UIStatusBarStyleDefault;
    return UIStatusBarStyleDefault;
}

//: - (void)messagesDeletedInSession:(NIMSession *)session{
- (void)messagesDeletedInSession:(NIMSession *)session{
    //: self.sessionUnreadCount = [NIMSDK sharedSDK].conversationManager.allUnreadCount;
    self.absoluteNumber = [NIMSDK sharedSDK].conversationManager.allUnreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}

//: - (void)hideTabBar {
- (void)taproom {
    // 如果已经隐藏，则不需要重复操作
    //: if (self.customTabBar.hidden) {
    if (self.bar.hidden) {
        //: return;
        return;
    }

    // 直接设置可见性
    //: self.customTabBar.hidden = YES;
    self.bar.hidden = YES;

    // 调整容器视图的大小
    //: CGRect containerFrame = self.containerView.frame;
    CGRect containerFrame = self.roving.frame;
    //: containerFrame.size.height = self.view.bounds.size.height;
    containerFrame.size.height = self.view.bounds.size.height;
	[self setDrama:_formatBehaviorQuantity];
    //: self.containerView.frame = containerFrame;
    self.roving.frame = containerFrame;
	[self setDrama:_formatBehaviorQuantity];

    // 确保选中的视图控制器的视图大小与容器一致
    //: if (self.selectedViewController) {
    if (self.onenseBy) {
        //: self.selectedViewController.view.frame = self.containerView.bounds;
        self.onenseBy.view.frame = self.roving.bounds;
    }

    // 强制更新布局
    //: [self.view setNeedsLayout];
    [self.view setNeedsLayout];
    //: [self.view layoutIfNeeded];
    [self.view layoutIfNeeded];
}

//: - (void)setUpSubNav{
- (void)bind{
    //: NSMutableArray *handleArray = [[NSMutableArray alloc] init];
    NSMutableArray *handleArray = [[NSMutableArray alloc] init];
    //: NSMutableArray *vcArray = [[NSMutableArray alloc] init];
    NSMutableArray *vcArray = [[NSMutableArray alloc] init];
    //: [self.tabbars enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    [self.screen enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        //: NSDictionary * item =[self vcInfoForTabType:[obj integerValue]];
        NSDictionary * item =[self with:[obj integerValue]];
        //: NSString *vcName = item[@"vc"];
        NSString *vcName = item[StringFromRefugeData(widgetTapName)];
        //: NSString *title = @"";
        NSString *title = @"";
        //: if(idx == 0){
        if(idx == 0){
            //: title = [NTESLanguageManager getTextWithKey:@"activity_user_profile_chat"];
            title = [BombardmentMinimumManageress more:StringFromRefugeData(viewMovieSettings)];
        //: }else if (idx == 1){
        }else if (idx == 1){
            //: title = [NTESLanguageManager getTextWithKey:@"contacts_list_title"];
            title = [BombardmentMinimumManageress more:StringFromRefugeData(kJoinMarkKey)];
        //: }else if (idx == 2){
        }else if (idx == 2){
            //: title = [NTESLanguageManager getTextWithKey:@"main_tab_my"];
            title = [BombardmentMinimumManageress more:StringFromRefugeData(styleItemDevice)];
        }

        //: NSString *imageName = item[@"image"];
        NSString *imageName = item[StringFromRefugeData(viewSequencePreference)];
        //: NSString *imageSelected = item[@"selectedImage"];
        NSString *imageSelected = item[StringFromRefugeData(widgetGrainName)];
        //: Class clazz = NSClassFromString(vcName);
        Class clazz = NSClassFromString(vcName);
        //: UIViewController *vc = [[clazz alloc] initWithNibName:nil bundle:nil];
        UIViewController *vc = [[clazz alloc] initWithNibName:nil bundle:nil];
        //: vc.hidesBottomBarWhenPushed = NO;
        vc.hidesBottomBarWhenPushed = NO;
        //: UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:vc];
        UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:vc];

        //: UIImage *normalImage = [UIImage imageNamed:imageName];
        UIImage *normalImage = [UIImage imageNamed:imageName];
        //: normalImage = [normalImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
        normalImage = [normalImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
        //: UIImage *selectImage = [UIImage imageNamed:imageSelected];
        UIImage *selectImage = [UIImage imageNamed:imageSelected];
        //: selectImage = [selectImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
        selectImage = [selectImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];

        //: nav.tabBarItem = [[UITabBarItem alloc] initWithTitle:title
        nav.tabBarItem = [[UITabBarItem alloc] initWithTitle:title
                                                       //: image:normalImage
                                                       image:normalImage
                                               //: selectedImage:selectImage];
                                               selectedImage:selectImage];
        //: nav.tabBarItem.tag = idx;
        nav.tabBarItem.tag = idx;
        //: NSInteger badge = [item[@"badgeValue"] integerValue];
        NSInteger badge = [item[StringFromRefugeData(spacingMeantimeTrackPath)] integerValue];
        //: if (badge) {
        if (badge) {
            //: nav.tabBarItem.badgeValue = [NSString stringWithFormat:@"%zd",badge];
            nav.tabBarItem.badgeValue = [NSString stringWithFormat:@"%zd",badge];
        }
        //: NTESNavigationHandler *handler = [[NTESNavigationHandler alloc] initWithNavigationController:nav];
        PortStepGender *handler = [[PortStepGender alloc] initWithForward:nav];
        //: nav.delegate = handler;
        nav.delegate = handler;

        //: if (@available(iOS 15.0, *)) {
        if (@available(iOS 15.0, *)) {

            //: NSDictionary *dic = @{NSForegroundColorAttributeName : [UIColor whiteColor],
            NSDictionary *dic = @{NSForegroundColorAttributeName : [UIColor whiteColor],
                                  //: NSFontAttributeName : [UIFont boldSystemFontOfSize:11]};
                                  NSFontAttributeName : [UIFont boldSystemFontOfSize:11]};

            //: UINavigationBarAppearance *barApp = [UINavigationBarAppearance new];
            UINavigationBarAppearance *barApp = [UINavigationBarAppearance new];
            //: barApp.backgroundColor = [UIColor colorWithHexString:@"#A148FF"];
            barApp.backgroundColor = [UIColor fraction:StringFromRefugeData(appEverSequenceDevice)];
            //: barApp.shadowColor = [UIColor colorWithHexString:@"#A148FF"];
            barApp.shadowColor = [UIColor fraction:StringFromRefugeData(appEverSequenceDevice)];
            //: barApp.titleTextAttributes = dic;
            barApp.titleTextAttributes = dic;

            //: nav.navigationBar.scrollEdgeAppearance = barApp;
            nav.navigationBar.scrollEdgeAppearance = barApp;
            //: nav.navigationBar.standardAppearance = barApp;
            nav.navigationBar.standardAppearance = barApp;
        }

        //: [vcArray addObject:nav];
        [vcArray addObject:nav];
        //: [handleArray addObject:handler];
        [handleArray addObject:handler];
    //: }];
    }];
    //: self.viewControllers = [NSArray arrayWithArray:vcArray];
    self.enableViewController = [NSArray arrayWithArray:vcArray];
	[self setDrama:_formatBehaviorQuantity];
    //: self.navigationHandlers = [NSArray arrayWithArray:handleArray];
    self.memory = [NSArray arrayWithArray:handleArray];
	[self setDrama:_formatBehaviorQuantity];


    //: UINavigationBar *navBar = [UINavigationBar appearance];
    UINavigationBar *navBar = [UINavigationBar appearance];

    //: NSDictionary *dic = @{NSForegroundColorAttributeName : [UIColor blackColor],
    NSDictionary *dic = @{NSForegroundColorAttributeName : [UIColor blackColor],
                          //: NSFontAttributeName : [UIFont boldSystemFontOfSize:16]};
                          NSFontAttributeName : [UIFont boldSystemFontOfSize:16]};

    //: navBar.barTintColor = [UIColor colorWithPatternImage:[SNGradientHelper getLinearGradientImage:[UIColor colorWithHexString:@"#875FFA"] and:[UIColor colorWithHexString:@"#612CF9"] directionType:SNLinearGradientDirectionVertical]];
    navBar.barTintColor = [UIColor colorWithPatternImage:[RecognizeYardSecurity exclusive:[UIColor fraction:StringFromRefugeData(spacingItemHelper)] stick:[UIColor fraction:StringFromRefugeData(moduleMushData)] shouldGradientDirection:SNLinearGradientDirectionVertical]];
	[self setDrama:_formatBehaviorQuantity];
    //: [navBar setTitleTextAttributes:dic];
    [navBar setTitleTextAttributes:dic];
    //: [navBar setShadowImage:[UIImage new]];
    [navBar setShadowImage:[UIImage new]];
    //: [navBar setBackgroundImage:[SNGradientHelper getLinearGradientImage:[UIColor colorWithHexString:@"#875FFA"] and:[UIColor colorWithHexString:@"#612CF9"] directionType:SNLinearGradientDirectionLevel] forBarMetrics:UIBarMetricsDefault];
    [navBar setBackgroundImage:[RecognizeYardSecurity exclusive:[UIColor fraction:StringFromRefugeData(spacingItemHelper)] stick:[UIColor fraction:StringFromRefugeData(moduleMushData)] shouldGradientDirection:SNLinearGradientDirectionLevel] forBarMetrics:UIBarMetricsDefault];

    //: navBar.translucent = YES;
    navBar.translucent = YES;
    //: navBar.tintColor = [UIColor grayColor];
    navBar.tintColor = [UIColor grayColor];

    // 设置自定义TabBar的样式
    //: self.customTabBar.backgroundColor = [UIColor whiteColor];
    self.bar.backgroundColor = [UIColor whiteColor];
    // 刷新自定义TabBar
    //: [self.customTabBar refreshTabBarItems];
    [self.bar utterEnable];
}

//: - (void)customTabBarController:(UIViewController *)tabBarController didSelectViewController:(UIViewController *)viewController {
- (void)select:(UIViewController *)tabBarController couvadeInLink:(UIViewController *)viewController {
    //: [UIView setAnimationsEnabled:YES];
    [UIView setAnimationsEnabled:YES];
}

//: #pragma mark - Notification
#pragma mark - Notification
//: - (void)onCustomNotifyChanged:(NSNotification *)notification
- (void)limbed:(NSNotification *)notification
{
    //: NTESCustomNotificationDB *db = [NTESCustomNotificationDB sharedInstance];
    BelowDb *db = [BelowDb instance];
    //: self.customSystemUnreadCount = db.unreadCount;
    self.wait = db.conformTo;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSettingBadge];
    [self surround];
}


//: - (NSArray *)tabbars{
- (NSArray *)screen{
    //: self.sessionUnreadCount = [NIMSDK sharedSDK].conversationManager.allUnreadCount;
    self.absoluteNumber = [NIMSDK sharedSDK].conversationManager.allUnreadCount;
	[self setDrama:_formatBehaviorQuantity];
//    self.systemUnreadCount   = [NIMSDK sharedSDK].systemNotificationManager.allUnreadCount;
    //: self.customSystemUnreadCount = [[NTESCustomNotificationDB sharedInstance] unreadCount];
    self.wait = [[BelowDb instance] conformTo];
    //: NSMutableArray *items = [[NSMutableArray alloc] init];
    NSMutableArray *items = [[NSMutableArray alloc] init];

    //: [items addObject:@(0)];
    [items addObject:@(0)];
    //: [items addObject:@(1)];
    [items addObject:@(1)];
    //: [items addObject:@(2)];
    [items addObject:@(2)];
//    [items addObject:@(3)];

    //: return items;
    return items;
}

//: - (UIInterfaceOrientationMask)supportedInterfaceOrientations{
- (UIInterfaceOrientationMask)supportedInterfaceOrientations{
    //: BOOL enableRotate = [NTESBundleSetting sharedConfig].enableRotate;
    BOOL enableRotate = [AgencySetting safety].provide;
    //: return enableRotate ? [self.selectedViewController supportedInterfaceOrientations] : UIInterfaceOrientationMaskPortrait;
    return enableRotate ? [self.onenseBy supportedInterfaceOrientations] : UIInterfaceOrientationMaskPortrait;
}

- (NSInteger)principal:(NSInteger)drama {
    //: OC_CUSTOM_PROPERTY_INJECT
    _drama = drama;
    return drama;
}

//: #pragma mark - Rotate
#pragma mark - Rotate

//: - (BOOL)shouldAutorotate{
- (BOOL)shouldAutorotate{
    //: BOOL enableRotate = [NTESBundleSetting sharedConfig].enableRotate;
    BOOL enableRotate = [AgencySetting safety].provide;
    //: return enableRotate ? [self.selectedViewController shouldAutorotate] : NO;
    return enableRotate ? [self.onenseBy shouldAutorotate] : NO;
}

//: - (void)showTabBar {
- (void)audience {
    // 如果已经显示，则不需要重复操作
    //: if (!self.customTabBar.hidden) {
    if (!self.bar.hidden) {
        //: return;
        return;
    }

    // 确保自定义 TabBar 存在
    //: if (!self.customTabBar) {
    if (!self.bar) {
        //: return;
        return;
    }

    // 直接设置可见性
    //: self.customTabBar.hidden = NO;
    self.bar.hidden = NO;
	[self setDrama:_formatBehaviorQuantity];
    //: self.customTabBar.alpha = 1.0; 
    self.bar.alpha = 1.0;
	[self setDrama:_formatBehaviorQuantity]; // 确保透明度为 1

    // 调整容器视图的大小
    //: CGRect containerFrame = self.containerView.frame;
    CGRect containerFrame = self.roving.frame;
    //: containerFrame.size.height = self.view.bounds.size.height - (({ BOOL isPhoneX = NO; if (@available(iOS 11.0, *)) { UIEdgeInsets insets = ({UIEdgeInsets i; if(@available(iOS 11.0, *)) {i = ({UIWindow *win = nil; if (@available(iOS 13.0, *)) { NSSet *connectedScenes = [UIApplication sharedApplication].connectedScenes; for (UIScene *scene in connectedScenes) { if ([scene isKindOfClass:[UIWindowScene class]] && scene.activationState == UISceneActivationStateForegroundActive) { UIWindowScene *windowScene = (UIWindowScene *)scene; for (UIWindow *w in windowScene.windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = windowScene.windows.firstObject; } if (win) { break; } } } } if (!win) { for (UIWindow *w in [UIApplication sharedApplication].windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = [UIApplication sharedApplication].windows.firstObject; } } if (!win) { if ([[UIApplication sharedApplication] delegate] && [[[UIApplication sharedApplication] delegate] respondsToSelector:@selector(window)]) { win = [[[UIApplication sharedApplication] delegate] window]; } } win;}).safeAreaInsets;} else {i = UIEdgeInsetsZero;} i;}); isPhoneX = (insets.bottom > 0.0) && (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone); } isPhoneX;}) ? 49 + 35 : 49);
    containerFrame.size.height = self.view.bounds.size.height - (({ BOOL isPhoneX = NO; if (@available(iOS 11.0, *)) { UIEdgeInsets insets = ({UIEdgeInsets i; if(@available(iOS 11.0, *)) {i = ({UIWindow *win = nil; if (@available(iOS 13.0, *)) { NSSet *connectedScenes = [UIApplication sharedApplication].connectedScenes; for (UIScene *scene in connectedScenes) { if ([scene isKindOfClass:[UIWindowScene class]] && scene.activationState == UISceneActivationStateForegroundActive) { UIWindowScene *windowScene = (UIWindowScene *)scene; for (UIWindow *w in windowScene.windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = windowScene.windows.firstObject; } if (win) { break; } } } } if (!win) { for (UIWindow *w in [UIApplication sharedApplication].windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = [UIApplication sharedApplication].windows.firstObject; } } if (!win) { if ([[UIApplication sharedApplication] delegate] && [[[UIApplication sharedApplication] delegate] respondsToSelector:@selector(propertyWindowwed)]) { win = [[[UIApplication sharedApplication] delegate] window]; } } win;}).safeAreaInsets;} else {i = UIEdgeInsetsZero;} i;}); isPhoneX = (insets.bottom > 0.0) && (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone); } isPhoneX;}) ? 49 + 35 : 49);
    //: self.containerView.frame = containerFrame;
    self.roving.frame = containerFrame;

    // 设置 TabBar 的位置
    //: CGRect tabBarFrame = CGRectMake(0, self.view.bounds.size.height - (({ BOOL isPhoneX = NO; if (@available(iOS 11.0, *)) { UIEdgeInsets insets = ({UIEdgeInsets i; if(@available(iOS 11.0, *)) {i = ({UIWindow *win = nil; if (@available(iOS 13.0, *)) { NSSet *connectedScenes = [UIApplication sharedApplication].connectedScenes; for (UIScene *scene in connectedScenes) { if ([scene isKindOfClass:[UIWindowScene class]] && scene.activationState == UISceneActivationStateForegroundActive) { UIWindowScene *windowScene = (UIWindowScene *)scene; for (UIWindow *w in windowScene.windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = windowScene.windows.firstObject; } if (win) { break; } } } } if (!win) { for (UIWindow *w in [UIApplication sharedApplication].windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = [UIApplication sharedApplication].windows.firstObject; } } if (!win) { if ([[UIApplication sharedApplication] delegate] && [[[UIApplication sharedApplication] delegate] respondsToSelector:@selector(window)]) { win = [[[UIApplication sharedApplication] delegate] window]; } } win;}).safeAreaInsets;} else {i = UIEdgeInsetsZero;} i;}); isPhoneX = (insets.bottom > 0.0) && (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone); } isPhoneX;}) ? 49 + 35 : 49), self.view.bounds.size.width, (({ BOOL isPhoneX = NO; if (@available(iOS 11.0, *)) { UIEdgeInsets insets = ({UIEdgeInsets i; if(@available(iOS 11.0, *)) {i = ({UIWindow *win = nil; if (@available(iOS 13.0, *)) { NSSet *connectedScenes = [UIApplication sharedApplication].connectedScenes; for (UIScene *scene in connectedScenes) { if ([scene isKindOfClass:[UIWindowScene class]] && scene.activationState == UISceneActivationStateForegroundActive) { UIWindowScene *windowScene = (UIWindowScene *)scene; for (UIWindow *w in windowScene.windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = windowScene.windows.firstObject; } if (win) { break; } } } } if (!win) { for (UIWindow *w in [UIApplication sharedApplication].windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = [UIApplication sharedApplication].windows.firstObject; } } if (!win) { if ([[UIApplication sharedApplication] delegate] && [[[UIApplication sharedApplication] delegate] respondsToSelector:@selector(window)]) { win = [[[UIApplication sharedApplication] delegate] window]; } } win;}).safeAreaInsets;} else {i = UIEdgeInsetsZero;} i;}); isPhoneX = (insets.bottom > 0.0) && (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone); } isPhoneX;}) ? 49 + 35 : 49));
    CGRect tabBarFrame = CGRectMake(0, self.view.bounds.size.height - (({ BOOL isPhoneX = NO; if (@available(iOS 11.0, *)) { UIEdgeInsets insets = ({UIEdgeInsets i; if(@available(iOS 11.0, *)) {i = ({UIWindow *win = nil; if (@available(iOS 13.0, *)) { NSSet *connectedScenes = [UIApplication sharedApplication].connectedScenes; for (UIScene *scene in connectedScenes) { if ([scene isKindOfClass:[UIWindowScene class]] && scene.activationState == UISceneActivationStateForegroundActive) { UIWindowScene *windowScene = (UIWindowScene *)scene; for (UIWindow *w in windowScene.windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = windowScene.windows.firstObject; } if (win) { break; } } } } if (!win) { for (UIWindow *w in [UIApplication sharedApplication].windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = [UIApplication sharedApplication].windows.firstObject; } } if (!win) { if ([[UIApplication sharedApplication] delegate] && [[[UIApplication sharedApplication] delegate] respondsToSelector:@selector(propertyWindowwed)]) { win = [[[UIApplication sharedApplication] delegate] window]; } } win;}).safeAreaInsets;} else {i = UIEdgeInsetsZero;} i;}); isPhoneX = (insets.bottom > 0.0) && (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone); } isPhoneX;}) ? 49 + 35 : 49), self.view.bounds.size.width, (({ BOOL isPhoneX = NO; if (@available(iOS 11.0, *)) { UIEdgeInsets insets = ({UIEdgeInsets i; if(@available(iOS 11.0, *)) {i = ({UIWindow *win = nil; if (@available(iOS 13.0, *)) { NSSet *connectedScenes = [UIApplication sharedApplication].connectedScenes; for (UIScene *scene in connectedScenes) { if ([scene isKindOfClass:[UIWindowScene class]] && scene.activationState == UISceneActivationStateForegroundActive) { UIWindowScene *windowScene = (UIWindowScene *)scene; for (UIWindow *w in windowScene.windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = windowScene.windows.firstObject; } if (win) { break; } } } } if (!win) { for (UIWindow *w in [UIApplication sharedApplication].windows) { if (w.isKeyWindow) { win = w; break; } } if (!win) { win = [UIApplication sharedApplication].windows.firstObject; } } if (!win) { if ([[UIApplication sharedApplication] delegate] && [[[UIApplication sharedApplication] delegate] respondsToSelector:@selector(propertyWindowwed)]) { win = [[[UIApplication sharedApplication] delegate] window]; } } win;}).safeAreaInsets;} else {i = UIEdgeInsetsZero;} i;}); isPhoneX = (insets.bottom > 0.0) && (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone); } isPhoneX;}) ? 49 + 35 : 49));
    //: self.customTabBar.frame = tabBarFrame;
    self.bar.frame = tabBarFrame;
	[self setDrama:_formatBehaviorQuantity];

    // 确保 TabBar 在父视图上
    //: if (!self.customTabBar.superview) {
    if (!self.bar.superview) {
        //: [self.view addSubview:self.customTabBar];
        [self.view addSubview:self.bar];
    }

    // 确保选中的视图控制器的视图大小与容器一致
    //: if (self.selectedViewController) {
    if (self.onenseBy) {
        //: self.selectedViewController.view.frame = self.containerView.bounds;
        self.onenseBy.view.frame = self.roving.bounds;
    }

    // 刷新 TabBar 项
    //: [self.customTabBar refreshTabBarItems];
    [self.bar utterEnable];

    // 强制更新布局
    //: [self.view setNeedsLayout];
    [self.view setNeedsLayout];
    //: [self.view layoutIfNeeded];
    [self.view layoutIfNeeded];

    // 确保 TabBar 在最前面
    //: [self.view bringSubviewToFront:self.customTabBar];
    [self.view bringSubviewToFront:self.bar];
}

//: #pragma mark - Notification
#pragma mark - Notification
//: - (void)languageChanged:(NSNotification *)noti {
- (void)groupped:(NSNotification *)noti {
    // 重新设置导航栏和标签栏
    //: [self setUpSubNav];
    [self bind];

    // 确保在语言切换后 TabBar 可见
    //: dispatch_after(dispatch_time((0ull), (int64_t)(0.1 * 1000000000ull)), dispatch_get_main_queue(), ^{
    dispatch_after(dispatch_time((0ull), (int64_t)(0.1 * 1000000000ull)), dispatch_get_main_queue(), ^{
        //: if (self.customTabBar.hidden) {
        if (self.bar.hidden) {
            //: [self showTabBar];
            [self audience];
        }
    //: });
    });
}

//: - (void)didUpdateUnreadCountDic:(NSDictionary *)unreadCountDic
- (void)didUpdateUnreadCountDic:(NSDictionary *)unreadCountDic
{
    //: NSInteger unreadCount = [[NIMSDK sharedSDK].conversationManager allUnreadCount:YES];
    NSInteger unreadCount = [[NIMSDK sharedSDK].conversationManager allUnreadCount:YES];
    //: self.sessionUnreadCount = unreadCount;
    self.absoluteNumber = unreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}

//: #pragma mark - NIMSystemNotificationManagerDelegate
#pragma mark - NIMSystemNotificationManagerDelegate
//: - (void)onSystemNotificationCountChanged:(NSInteger)unreadCount
- (void)onSystemNotificationCountChanged:(NSInteger)unreadCount
{
    //: self.systemUnreadCount = unreadCount;
    self.formatBehaviorQuantity = unreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshContactBadge];
    [self sumeraction];
}

//: - (void)viewDidLoad {
- (void)viewDidLoad {
    //: [super viewDidLoad];
    [super viewDidLoad];
    //: [self setUpSubNav];
    [self bind];
    //: [[NIMSDK sharedSDK].systemNotificationManager addDelegate:self];
    [[NIMSDK sharedSDK].systemNotificationManager addDelegate:self];
    //: [[NIMSDK sharedSDK].conversationManager addDelegate:self];
    [[NIMSDK sharedSDK].conversationManager addDelegate:self];

    //: [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(onCustomNotifyChanged:) name:@"NTESCustomNotificationCountChanged" object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(limbed:) name:StringFromRefugeData(styleMatterText) object:nil];
    //: [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(languageChanged:) name:@"KEKENotificationLanguageChanged" object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(groupped:) name:StringFromRefugeData(widgetTerrainGlobalTitle) object:nil];

    // 设置自定义TabBar的颜色
    //: self.customTabBar.itemTintColor = [UIColor colorWithHexString:@"#888888"];
    self.bar.acceptSum = [UIColor fraction:StringFromRefugeData(kBuildSettings)];
	[self setDrama:_formatBehaviorQuantity];
    //: self.customTabBar.selectedItemTintColor = [UIColor colorWithHexString:@"#000000"];
    self.bar.to = [UIColor fraction:StringFromRefugeData(screenIslandScandalData)];
	[self setDrama:_formatBehaviorQuantity];

    //: self.delegate = self;
    self.commentMaxxed = self;
}

//: - (void)viewWillAppear:(BOOL)animated{
- (void)viewWillAppear:(BOOL)animated{
    //: [super viewWillAppear:animated];
    [super viewWillAppear:animated];

    // 设置自定义TabBar的颜色
    //: self.customTabBar.itemTintColor = [UIColor colorWithHexString:@"#888888"];
    self.bar.acceptSum = [UIColor fraction:StringFromRefugeData(kBuildSettings)];
    //: self.customTabBar.selectedItemTintColor = [UIColor colorWithHexString:@"#000000"];
    self.bar.to = [UIColor fraction:StringFromRefugeData(screenIslandScandalData)];
	[self setDrama:_formatBehaviorQuantity];

    // 如果是根视图控制器，应该显示 TabBar
    //: BOOL isRoot = YES;
    BOOL isRoot = YES;
    //: for (UINavigationController *nav in self.viewControllers) {
    for (UINavigationController *nav in self.enableViewController) {
        //: if (nav.viewControllers.count > 1) {
        if (nav.viewControllers.count > 1) {
            //: isRoot = NO;
            isRoot = NO;
	[self setDrama:_formatBehaviorQuantity];
            //: break;
            break;
        }
    }

    //: if (isRoot && self.customTabBar.hidden) {
    if (isRoot && self.bar.hidden) {
        //: [self showTabBar];
        [self audience];
    }
}

//: - (void)refreshSettingBadge{
- (void)surround{
    //: NSString *badgeValue = self.customSystemUnreadCount ? @(self.customSystemUnreadCount).stringValue : nil;
    NSString *badgeValue = self.wait ? @(self.wait).stringValue : nil;
    //: [super setBadgeValue:badgeValue atIndex:EnumUserMainTabTypeSetting];
    [super multiple:badgeValue than:EnumUserMainTabTypeSetting];
}

//: - (void)refreshContactBadge{
- (void)sumeraction{
    // 注释掉的原有代码
    // UINavigationController *nav = self.viewControllers[EnumUserMainTabTypeContact];
    // NSInteger badge = self.systemUnreadCount;
    // nav.tabBarItem.badgeValue = badge ? @(badge).stringValue : nil;
}


//: - (void)viewDidLayoutSubviews {
- (void)viewDidLayoutSubviews {
    //: [super viewDidLayoutSubviews];
    [super viewDidLayoutSubviews];
}


//: - (BOOL)customTabBarController:(UIViewController *)tabBarController shouldSelectViewController:(UIViewController *)viewController {
- (BOOL)jump:(UIViewController *)tabBarController writing:(UIViewController *)viewController {
    //: [UIView setAnimationsEnabled:NO];
    [UIView setAnimationsEnabled:NO];
    //: return YES;
    return YES;
}

//: - (void)didUpdateRecentSession:(NIMRecentSession *)recentSession
- (void)didUpdateRecentSession:(NIMRecentSession *)recentSession
              //: totalUnreadCount:(NSInteger)totalUnreadCount{
              totalUnreadCount:(NSInteger)totalUnreadCount{
    //: self.sessionUnreadCount = totalUnreadCount;
    self.absoluteNumber = totalUnreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}


//: @end

- (void)setDrama:(NSInteger)drama {
    //: OC_CUSTOM_PROPERTY_INJECT
    _drama = drama;
}

//: #pragma mark - NIMConversationManagerDelegate
#pragma mark - NIMConversationManagerDelegate
//: - (void)didAddRecentSession:(NIMRecentSession *)recentSession
- (void)didAddRecentSession:(NIMRecentSession *)recentSession
           //: totalUnreadCount:(NSInteger)totalUnreadCount{
           totalUnreadCount:(NSInteger)totalUnreadCount{
    //: self.sessionUnreadCount = totalUnreadCount;
    self.absoluteNumber = totalUnreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}

//: - (void)onBatchMarkMessagesReadInSessions:(NSArray<NIMSession *> *)sessions
- (void)onBatchMarkMessagesReadInSessions:(NSArray<NIMSession *> *)sessions
{
    //: self.sessionUnreadCount = [NIMSDK sharedSDK].conversationManager.allUnreadCount;
    self.absoluteNumber = [NIMSDK sharedSDK].conversationManager.allUnreadCount;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}

//: - (void)viewDidAppear:(BOOL)animated
- (void)viewDidAppear:(BOOL)animated
{
    //: [super viewDidAppear:animated];
    [super viewDidAppear:animated];
    //会话界面发送拍摄的视频，拍摄结束后点击发送后可能顶部会有红条，导致的界面错位。
    //: self.view.frame = [UIScreen mainScreen].bounds;
    self.view.frame = [UIScreen mainScreen].bounds;
	[self setDrama:_formatBehaviorQuantity];
}

//: - (void)allMessagesDeleted{
- (void)allMessagesDeleted{
    //: self.sessionUnreadCount = 0;
    self.absoluteNumber = 0;
	[self setDrama:_formatBehaviorQuantity];
    //: [self refreshSessionBadge];
    [self awake];
}


@end

Byte * RefugeDataToCache(Byte *data) {
    int scandal = data[0];
    int islandToothEntity = data[1];
    Byte modernEra = data[2];
    int memoryEra = data[3];
    if (!scandal) return data + memoryEra;
    for (int i = memoryEra; i < memoryEra + islandToothEntity; i++) {
        int value = data[i] + modernEra;
        if (value > 255) {
            value -= 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[memoryEra + islandToothEntity] = 0;
    return data + memoryEra;
}

NSString *StringFromRefugeData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)RefugeDataToCache(data)];
}
